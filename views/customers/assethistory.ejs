
<%- include('../includes/head.ejs') -%>
<%- include('../includes/navigation.ejs') -%>

<%- include('../includes/header.ejs') -%>
<%- include('../components/searchbartr.ejs') -%>
<a href="#" class="btn btn-danger ml-3" type="button" aria-label="Add New">Bulk Pay Credit</a>
</div>
</div>


</div>
</div>
</div>
<div class="container-fluid mt--6">
  <style>
    .filter-box {
        background: #fff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        margin-bottom: 10px;
    }
</style>


  <div class="row">


    
    <div class="col-12">

    <div class="filter-box">
    <h5 class="mb-3">Filter By</h5>
    <div class="row g-3">
        <!-- ID -->
        <div class="col-md-3">
            <label class="form-label">Sales Man I.D</label>
            <input type="text" class="form-control" placeholder="Search ID Here">
        </div>
        <div class="col-md-3">
          <label class="form-label">Asset</label>
          <input type="text" class="form-control" placeholder="Search ID Here">
      </div>   
      <div class="col-md-3">
        <label class="form-label">Lend Type</label>
        <input type="text" class="form-control" placeholder="Search ID Here">
    </div>
        <div class="col-md-3">
            <label class="form-label">From</label>
            <input type="date" class="form-control">
        </div>
        <!-- Date -->
        <div class="col-md-3">
            <label class="form-label">To</label>
            <input type="date" class="form-control">
        </div>
        <div class="col-md-3 mb-1 d-flex align-items-end">
          <button class="btn btn-sm filter-btn mr-2">
            <i class="fas fa-filter mr-1"></i> Apply
          </button>
          <button class="btn btn-outline-secondary">
            <i class="fas fa-sync-alt mr-1"></i> Reset
          </button>
        </div>
    </div>
</div>
  

    </div>
    <div class="col-12">

</div>
<div class="col-12">
  <ul class="nav nav-tabs nav-tabs-custom" role="tablist">
   <li class="nav-item">
      <a class="nav-link active" id="salesman-tab"  href="/customerassethistory/<%=id%>">
        <i class="fa-solid fa-boxes-stacked"></i>        Asset History
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="salesman-tab"  href="/customerorderhistory/<%=id%>">
        <i class="fa-solid fa-list"></i>
        Order History
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="salesman-tab"  href="/creditpayment/<%=id%>">
        <i class="fa-solid fa-money-bill-wave"></i>
                Payments History
      </a>
    </li>
    

    
    </ul>
    </div>
    <div class="col">
      <div class="card">
        <!-- Card header -->
        <div class="card-header border-0 mb-2">
          <h3 class="mb-0 text-white">Asset History of <%=id%></h3>
        </div>
        <!-- Light table -->
        <div class="table-responsive">
          <table id="assettable" class="table align-items-center table-flush">
            <thead>
              <tr>
                <th scope="col" class="sort" data-sort="createdAt">Created At</th>
               
                <th scope="col" class="sort" data-sort="assetType">Asset Type</th>
                <th scope="col" class="sort" data-sort="noOfAssets">No. of Assets</th>
                <th scope="col" class="sort" data-sort="securityDeposit">Security Deposit</th>
                <th scope="col" class="sort" data-sort="lendType">Lend Type</th>
                <th scope="col" class="sort" data-sort="truckId">Truck ID</th>
                <th scope="col" class="sort" data-sort="salesmanId">Salesman ID</th>
                <th scope="col" class="sort" data-sort="actions">Actions</th>
              </tr>
            </thead>
            
            <tbody class="list">
              <tr>
                
              </tr>
            </tbody>
          </table>
        </div>
        <!-- Card footer -->
      
      </div>
    </div>
  </div>
    <!-- Footer -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    
    <script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap4.min.js"></script>
    
    <script>
   $(document).ready(function () {
  var datatable = $("#assettable").DataTable({
    responsive: true,
    processing: true,
    serverSide: true,
    ajax: {
      url: "/getcustomerassets",
      dataSrc: "docs",
      data: function (d) {
        d.customer = '<%= id %>'; // Pass customerId to server
        return d;
      }
    },
    language: {
      paginate: {
        next: '<i class="fas fa-chevron-right"></i>',
        previous: '<i class="fas fa-chevron-left"></i>',
      },
      search: "_INPUT_",
      searchPlaceholder: "Search asset history...",
      lengthMenu: "Show _MENU_ records",
      info: "Showing _START_ to _END_ of _TOTAL_ records",
    },
    columns: [
    {
        data: "createdAt",
        title: "Created At",
        render: function (data) {
          return data ? new Date(data).toLocaleDateString() : "N/A";
        }
      },
      {
        data: "assetType",
        title: "Asset Type",
        render: function (data) {
          return data || "N/A";
        }
      },
      {
        data: "noOfAssets",
        title: "No. of Assets",
        render: function (data) {
          return data !== undefined ? data : "N/A";
        }
      },
      {
        data: "securityDeposit",
        title: "Security Deposit",
        render: function (data) {
          return data !== undefined ? `â‚¹${data}` : "N/A";
        }
      },
      {
        data: "lendType",
        title: "Lend Type",
        render: function (data) {
          return data || "N/A";
        }
      },
      {
        data: "truckId",
        title: "Truck ID",
        render: function (data) {
          return data || "N/A";
        }
      },
      {
        data: "salesmanId",
        title: "Salesman ID",
        render: function (data) {
          return data || "N/A";
        }
      },
  
      {
        data: null,
        title: "Actions",
        render: function (data, type, row) {
          return `
            <button class="btn btn-info btn-sm" data-id="${row._id}">View</button>
          `;
        }
      }
    ]
  });
});
 </script>

<%- include('../includes/footer.ejs') -%>

<%- include('../includes/end.ejs') -%>