<%- include('../includes/head.ejs') -%>
<%- include('../includes/navigation.ejs') -%>

<%- include('../includes/header.ejs') -%>
<%- include('../components/searchbartr.ejs') -%>
<style>
  /* Scoped styles for custom-nav-tabs */
  .custom-nav-tabs {
    display: flex;
    gap: 10px;
    /* Add space between tabs for clear distinction */
    padding: 0;
    margin: 0;
    list-style: none;
  }

  .filter-box {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      margin-bottom: 10px;
  }

  .custom-nav-tabs .nav-link {
    text-align: center;
    padding: 10px 15px;
    color: #000000;
    /* Slightly darker version of #61A3C0 */
    font-weight: bold;
    border: 1px solid #d1d9de;
    /* Subtle border for separation */
    border-radius: 5px;
    background-color: #e7e7e7;
    /* Light background to distinguish tabs */
    transition: all 0.3s ease;
  }

  .custom-nav-tabs {
    border-bottom: 0px;
  }

  .custom-nav-tabs .nav-link:hover {
    color: #ffffff;
    background-color: #61A3C0;
    /* Your primary color */
  }

  .custom-nav-tabs .nav-link.active {
    color: #ffffff;
    background-color: #4d8da9;
    /* Slightly darker primary color */
    border-color: #61A3C0;
  }
</style>

</div>
</div>
</div>
</div>
</div>
<div class="container-fluid mt--6">
    <div class="row">
      <div class="col-12 mb-2">
        <div class="filter-box">
          <h5 class="mb-3">Filter By</h5>
          <div class="row g-3">
            <div class="col-md-3">
              <label class="form-label">From</label>
              <input type="date" class="form-control" id="fromDate">
          </div>

          <!-- To Date -->
          <div class="col-md-3">
              <label class="form-label">To</label>
              <input type="date" class="form-control" id="toDate">
          </div>
              <!-- Customer ID -->
              <div class="col-md-3">
                <label class="form-label">Salesman</label>
                <select class="form-control" id="salesmanSelect">
                    <option value="">All Salesmen</option>
                    <option value="SM001">John Doe</option>
                    <option value="SM002">Jane Smith</option>
                    <option value="SM003">Mike Johnson</option>
                    <option value="SM004">Sarah Williams</option>
                </select>
            </div>
            <div class="col-md-3 d-flex align-items-end">
              <button class="btn btn-primary" id="filterBtn">Filter</button>
            </div>
          </div>
      </div>
  
      </div>
 
      <div class="col-12">
        <ul class="nav nav-tabs nav-tabs-custom" role="tablist">
          <li class="nav-item">
            <a class="nav-link" id="salesman-tab"  href="/report">
              <i class="fa-solid fa-users-gear mr-2"></i>Salesman Collection
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="salesman-tab"  href="/customerreport">
              <i class="ni ni-circle-08 mr-2"></i>Customer Report
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="salesman-tab"  href="/creditreport">
              <i class="fa-solid fa-credit-card mr-2"></i>Credit Report
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="salesman-tab"  href="/truckreport">
              <i class="fa-solid fa-truck mr-2"></i>Truck Report
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" id="salesman-tab"  href="/commissionreport">
              <i class="fa-solid fa-money-bill-wave mr-2"></i>Commission Report
            </a>
          </li>
        </ul>
      </div>  

      <div class="col">
        <div class="card">
          <div class="card-header">
            <div class="row align-items-center">
              <div class="col">
                <h3 class="mb-0 text-white"><i class="fas fa-money-bill-wave mr-2"></i>Commission Report</h3>
              </div>
              <div class="col text-right">
                <button class="btn btn-sm btn-light" id="exportBtn">
                  <i class="fas fa-file-export mr-1"></i> Export
                </button>
              </div>
            </div>
          </div>
          
          <div class="table-responsive">
            <table id="reporttable" class="table table-bordered">
              <thead class="thead-light">
                <tr>
                  <th>Salesman</th>
                  <th>Commission Scheme</th>
                  <th>Total Sales</th>
                  <th>Achievement</th>
                  <th>Base Commission</th>
                  <th>Incremental Bonus</th>
                  <th>Total Commission</th>
                </tr>
              </thead>
              <tbody>
                <!-- Dummy Data Rows -->
                <tr>
                  <td>John Doe</td>
                  <td>CS-001 (5% base + 1% bonus)</td>
                  <td>55,000.00</td>
                  <td>110.00%</td>
                  <td>2,750.00</td>
                  <td>550.00</td>
                  <td>3,300.00</td>
                </tr>
                <tr>
                  <td>John Doe</td>
                  <td>CS-002 (7% base + 1.5% bonus)</td>
                  <td>55,000.00</td>
                  <td>73.33%</td>
                  <td>0.00</td>
                  <td>0.00</td>
                  <td>0.00</td>
                </tr>
                <tr>
                  <td>Jane Smith</td>
                  <td>CS-001 (5% base + 1% bonus)</td>
                  <td>62,500.00</td>
                  <td>125.00%</td>
                  <td>3,125.00</td>
                  <td>1,562.50</td>
                  <td>4,687.50</td>
                </tr>
                <tr>
                  <td>Mike Johnson</td>
                  <td>CS-003 (6% base + 2% bonus)</td>
                  <td>48,000.00</td>
                  <td>96.00%</td>
                  <td>0.00</td>
                  <td>0.00</td>
                  <td>0.00</td>
                </tr>
                <tr>
                  <td>Sarah Williams</td>
                  <td>CS-004 (4% base + 0.5% bonus)</td>
                  <td>82,000.00</td>
                  <td>164.00%</td>
                  <td>3,280.00</td>
                  <td>2,624.00</td>
                  <td>5,904.00</td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <th colspan="2">Total</th>
                  <th>302,500.00</th>
                  <th></th>
                  <th>9,155.00</th>
                  <th>4,736.50</th>
                  <th>13,891.50</th>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>
      </div>
    </div>
</div>

<!-- Footer -->
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap4.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.print.min.js"></script>

<script>
  $(document).ready(function() {
    // Initialize DataTable with export buttons
    $('#reporttable').DataTable({
      dom: 'Bfrtip',
      buttons: [
        'copy', 'csv', 'excel', 'pdf', 'print'
      ],
      pageLength: 10,
      responsive: true
    });

    // Filter button click handler
    $('#filterBtn').click(function() {
      const fromDate = $('#fromDate').val();
      const toDate = $('#toDate').val();
      const salesmanId = $('#salesmanSelect').val();
      
      // In a real implementation, this would reload with filtered data
      alert('Filter functionality would load data for:\n' + 
            `From: ${fromDate || 'All dates'}\n` +
            `To: ${toDate || 'All dates'}\n` +
            `Salesman: ${salesmanId ? $('#salesmanSelect option:selected').text() : 'All salesmen'}`);
    });

    // Export button click handler
    $('#exportBtn').click(function() {
      // Trigger DataTable export
      const table = $('#reporttable').DataTable();
      table.button('.buttons-excel').trigger();
    });
  });
</script>

<%- include('../includes/footer.ejs') -%>
<%- include('../includes/end.ejs') -%>